<!DOCTYPE html>
<html>
<head>
    <title>Relatório de Status - {{ turma.nome }}</title>
    <style>
        @page {
            size: A4 landscape; /* Define a orientação como horizontal */
            margin: 10mm 10mm 10mm 10mm; 
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        h1 {
            text-align: center;
            font-size: 20px;
            margin-bottom: 10px;
        }
        .legenda {
            margin: 10px 0;
            text-align: center;
            font-size: 14px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 10px;
            border: 1px solid #000; /* Preto, sem cores */
            text-align: center;
        }
        th {
            font-weight: bold;
            text-transform: uppercase;
        }
        th.vertical {
            width: 50px; /* Ajuste a largura */
            height: 150px; /* Altura suficiente */
            padding: 0;
        }
        th.vertical div {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 150px; /* Define a altura */
            text-align: center;
            writing-mode: vertical-rl; /* Texto na vertical */
            transform: rotate(180deg); /* Rotaciona o texto */
        }
        td.recuperacao {
            font-weight: bold; /* Apenas "Recuperação" em negrito */
        }
    </style>
</head>
<body>
    <h1>Relatório de Status - {{ turma.nome }}</h1>
    <div class="legenda">
        <strong>Legenda:</strong> AP - Aprovado &nbsp;&nbsp;&nbsp; RC - Recuperação &nbsp;&nbsp;&nbsp; DS - Desistente
    </div>

    <table>
        <thead>
            <tr>
                <th>Estudante</th>
                {% for disciplina in disciplinas %}
                <th class="vertical"><div>{{ disciplina.nome }}</div></th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for linha in tabela %}
            <tr>
                <td>{{ linha.estudante }}</td>
                {% for status in linha.status_disciplinas %}
                <td class="{% if status.status == 'Recuperação' %}recuperacao{% endif %}">
                    {% if status.status == 'Aprovado' %}
                        AP
                    {% elif status.status == 'Recuperação' %}
                        RC
                    {% elif status.status == 'Desistente' %}
                        DS
                    {% else %}
                        --
                    {% endif %}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
